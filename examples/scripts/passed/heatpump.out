>> # Depeopanizer test (from old Hysim manual)
>> units Field
>> $thermo = Sim21Thermo.Peng-Robinson
pkgName: Peng-Robinson
>> / -> $thermo
Thermo case attached to a unit operation. / to /thermo
>> thermo + Propane ISOBUTANE n-BUTANE ISOPENTANE
Propane ISOBUTANE n-BUTANE ISOPENTANE 
>> 
>> Feed = Stream.Stream_Material()
>> Feed.In.T = 90
>> Feed.In.P = 55
>> Feed.In.MoleFlow = 3000
>> Feed.In.Fraction = 2.5 39 58 .5
>> 
>> c4split = Tower.Tower()
>> c4split.Stage_0 + 38  # forty stages`
>> 
>> cd c4split.Stage_0
/c4split.Stage_0
>> 
>> l = Tower.LiquidDraw()
>> l.Port.P = 60
>> l.nC4spec = Tower.VolFractionSpec()
>> l.nC4spec + n-BUTANE
>> l.nC4spec.Port = .05
>> 
>> reflux = Tower.RefluxRatioSpec()
>> reflux.Port = 7
>> 
>> cond = Tower.EnergyFeed(0)
>> estT = Tower.Estimate('T')
>> estT.Port = 100
>> 
>> cd ../Stage_1
/c4split.Stage_1
>> vap = Tower.InternalVapourClone()
>> /to_comp = Stream.Stream_Material()
>> vap.Port -> /to_comp.In
>> 
>> cd ../Stage_29
/c4split.Stage_29
>> f = Tower.Feed()
>> f.Port -> /Feed.Out
>> 
>> cd ../Stage_39
/c4split.Stage_39
>> l = Tower.LiquidDraw()
>> l.Port.P = 68
>> 
>> reb = Tower.EnergyFeed(1)
>> 
>> estT = Tower.Estimate('T')
>> estT.Port = 120
>> 
>> cd ..
/c4split
>> 
>> /liq_prod = Stream.Stream_Material()
>> /liq_prod.clone = Stream.ClonePort(1)
>> /liq_prod.In -> Stage_0.l.Port
>> 
>> /btm_prod = Stream.Stream_Material()
>> /btm_prod.In -> Stage_39.l.Port
>> 
>> TryToSolve = 1  # start calculation
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.045623
/c4split Inner Error 0.018955
/c4split Inner Error 0.003893
/c4split Inner Error 0.000759
/c4split Inner Error 0.000054
/c4split Inner Error 0.000021
/c4split Inner Error 0.000013
Inner loop is not changing significantly - exiting
/c4split Iteration 1 Outer Error 0.004348
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.038290
/c4split Inner Error 0.022148
Step size too small - Exiting inner loop
/c4split Iteration 2 Outer Error 0.001315
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.083569
/c4split Inner Error 0.051719
/c4split Inner Error 0.024147
/c4split Inner Error 0.010428
/c4split Inner Error 0.004245
/c4split Inner Error 0.002173
/c4split Inner Error 0.000627
/c4split Inner Error 0.000312
Step size too small - Exiting inner loop
/c4split Iteration 3 Outer Error 0.000869
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.011214
/c4split Inner Error 0.010065
/c4split Inner Error 0.007992
/c4split Inner Error 0.007948
/c4split Inner Error 0.006434
/c4split Inner Error 0.001667
/c4split Inner Error 0.000207
/c4split Inner Error 0.000052
/c4split Inner Error 0.000005
Inner loop converged
/c4split Iteration 4 Outer Error 0.000035
/c4split Inner Error 0.000443
/c4split Inner Error 0.000008
Inner loop converged
>> 
>> /liq_prod.Out
Port: /liq_prod.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 7.147964567258699e-06 = 
T                  = 81.62455747364066 = F
P                  = 60.0 = psia
MoleFlow           = 991.2410997588613 = lbmole/h
MassFlow           = 56561.18454122062 = lb/h
VolumeFlow         = 0.4380585819249583 = ft3/s
StdLiqVolumeFlow   = 0.44958429932521143 = ft3/s
H                  = -65177.02419734783 = Btu/lbmol
Energy             = -64595280.91145762 = Btu/hr
MolecularWeight    = 57.06097584782373 = 
ZFactor            = 0.01643261268106264 = 
PROPANE            = 0.0756580824331927 = 
ISOBUTANE          = 0.8736157858752174 = 
N-BUTANE           = 0.05072612577342597 = 
ISOPENTANE         = 5.918163966958765e-09 = 

>> /btm_prod.Out
Port: /btm_prod.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.0 = 
T                  = 114.64077174532655 = F
P                  = 68.0 = psia
MoleFlow           = 2008.758900241142 = lbmole/h
MassFlow           = 116963.82065877957 = lb/h
VolumeFlow         = 0.9160197790565625 = ft3/s
StdLiqVolumeFlow   = 0.9044231773222204 = ft3/s
H                  = -62646.245318205954 = Btu/lbmol
Energy             = -125820041.26915395 = Btu/hr
MolecularWeight    = 58.22690848799157 = 
ZFactor            = 0.018112363397291945 = 
PROPANE            = 2.2895546473856066e-06 = 
ISOBUTANE          = 0.15135521122313544 = 
N-BUTANE           = 0.8411752047988436 = 
ISOPENTANE         = 0.007467294423373544 = 

>> 
>> cd /
/
>> K-100 = Compressor.Compressor()
>> K-100.Efficiency = .75
>> K-100.Out.P = 235.1787
>> 
>> c4split.Stage_1.vap.Port -> K-100.In
>> 
>> E-100 = Heater.Cooler()
>> E-100.DeltaP = 5
>> 
>> K-100.Out -> E-100.In
>> E-100.OutQ -> c4split.Stage_39.reb.Port
>> 
>> E-101 = Heater.Cooler()
>> E-101.DeltaP = 5
>> E-100.Out -> E-101.In
>> 
>> CV-100 = Valve.Valve()
>> E-101.Out -> CV-100.In
>> 
>> V-100 = Flash.SimpleFlash()
>> CV-100.Out -> V-100.In
>> 
>> split = Split.Splitter()
>> V-100.Liq0 -> split.In
>> split.Out0 -> liq_prod.clone
>> 
>> copy /
Copied / to the clipboard
>> paste /
Pasting /
Pasted / as /RootClone
/RootClone.c4split Inner Error 0.000002
Inner loop converged
/RootClone.c4split Iteration 1 Outer Error 0.000001
/RootClone.c4split Inner Error 0.000002
Inner loop converged
>> 
>> /btm_prod.In
Port: /btm_prod.In + sim21.solver.Ports.Port_Material
Connected to: /c4split.LiquidDraw_39_l
VapFrac            = 0.0 | 
T                  = 114.64077174532655 | F
P                  = 68.0 | psia
MoleFlow           = 2008.758900241142 | lbmole/h
MassFlow           = 116963.82065877957 | lb/h
VolumeFlow         = 0.9160197790565625 | ft3/s
StdLiqVolumeFlow   = 0.9044231773222204 | ft3/s
H                  = -62646.245318205954 | Btu/lbmol
Energy             = -125820041.26915395 | Btu/hr
MolecularWeight    = 58.22690848799157 | 
ZFactor            = 0.018112363397291945 | 
PROPANE            = 2.2895546473856066e-06 | 
ISOBUTANE          = 0.15135521122313544 | 
N-BUTANE           = 0.8411752047988436 | 
ISOPENTANE         = 0.007467294423373544 | 

>> /RootClone.btm_prod.In
Port: /RootClone.btm_prod.In + sim21.solver.Ports.Port_Material
Connected to: /RootClone.c4split.LiquidDraw_39_l
VapFrac            = 2.218614541503761e-06 | 
T                  = 114.64381354684274 | F
P                  = 68.0 | psia
MoleFlow           = 2008.4607949253993 | lbmole/h
MassFlow           = 116946.49429709431 | lb/h
VolumeFlow         = 0.9159813055427098 | ft3/s
StdLiqVolumeFlow   = 0.9042849782039153 | ft3/s
H                  = -62645.74630778842 | Btu/lbmol
Energy             = -125800367.15652797 | Btu/hr
MolecularWeight    = 58.2269241165039 | 
ZFactor            = 0.01811419493411816 | 
PROPANE            = 2.2836795670049165e-06 | 
ISOBUTANE          = 0.15123582050344683 | 
N-BUTANE           = 0.8412934930617859 | 
ISOPENTANE         = 0.007468402755200194 | 

