>> # Nitrogen Rejection Unit (from old Hysim manual)
>> units Field
>> $thermo = Sim21Thermo.Peng-Robinson
pkgName: Peng-Robinson
>> / -> $thermo
Thermo case attached to a unit operation. / to /thermo
>> thermo + Nitrogen Methane Ethane PROPANE
Nitrogen Methane Ethane PROPANE 
>> thermo + ISOBUTANE n-BUTANE ISOPENTANE n-PENTANE
ISOBUTANE n-BUTANE ISOPENTANE n-PENTANE 
>> 
>> hp_feed = Stream.Stream_Material()
>> hp_ovhd = Stream.Stream_Material()
>> hp_btms = Stream.Stream_Material()
>> 
>> cd hp_feed.In
/hp_feed.In
>> T = -215
>> P = 380
>> MoleFlow = 1000
>> Fraction = .5454 .4153 .0347 .0036 .0004 .0003 .0002 .0001
>> cd /
/
>> 
>> hp_column = Tower.Tower()
>> hp_column.Stage_0 + 8  # ten stages`
>> 
>> cd hp_column.Stage_0
/hp_column.Stage_0
>> 
>> l = Tower.LiquidDraw()
>> l.Port.P = 370
>> 
>> l.Port -> /hp_ovhd.In
>> /hp_ovhd.In.Fraction.NITROGEN = .99
>> 
>> l.estF = Tower.Estimate('MoleFlow')
>> l.estF.Value = 200
>> 
>> cond = Tower.EnergyFeed(0)
>> 
>> estReflux = Tower.Estimate('Reflux')
>> estReflux.Value = 3
>> 
>> estT = Tower.Estimate('T')
>> estT.Value = -250
>> 
>> cd ../Stage_9
/hp_column.Stage_9
>> f = Tower.Feed()
>> f.Port -> /hp_feed.Out
>> 
>> l = Tower.LiquidDraw()
>> l.Port.P = 377
>> l.Port -> /hp_btms.In
>> 
>> estT = Tower.Estimate('T')
>> estT.Value = -230
>> 
>> cd ..
/hp_column
>> 
>> TryToSolve = 1  # start calculation
Calculating Jacobian for /hp_column
Calculating disturbance 10 of 10 in jacobian of /hp_column
/hp_column Inner Error 0.039983
/hp_column Inner Error 0.032712
/hp_column Inner Error 0.009385
/hp_column Inner Error 0.005678
/hp_column Inner Error 0.003157
/hp_column Inner Error 0.001609
/hp_column Inner Error 0.000547
/hp_column Inner Error 0.000359
/hp_column Inner Error 0.000174
/hp_column Inner Error 0.000110
/hp_column Inner Error 0.000049
/hp_column Inner Error 0.000017
/hp_column Inner Error 0.000009
Inner loop converged
/hp_column Iteration 1 Outer Error 0.205653
/hp_column Inner Error 0.047332
/hp_column Inner Error 0.046576
/hp_column Inner Error 0.021243
/hp_column Inner Error 0.013706
/hp_column Inner Error 0.009577
/hp_column Inner Error 0.006217
/hp_column Inner Error 0.001036
/hp_column Inner Error 0.000627
/hp_column Inner Error 0.000095
/hp_column Inner Error 0.000037
/hp_column Inner Error 0.000005
Inner loop converged
/hp_column Iteration 2 Outer Error 0.335368
/hp_column Inner Error 0.016669
/hp_column Inner Error 0.010283
/hp_column Inner Error 0.002316
/hp_column Inner Error 0.000329
/hp_column Inner Error 0.000031
/hp_column Inner Error 0.000012
/hp_column Inner Error 0.000002
Inner loop converged
/hp_column Iteration 3 Outer Error 0.025646
/hp_column Inner Error 0.003724
/hp_column Inner Error 0.001483
/hp_column Inner Error 0.000480
/hp_column Inner Error 0.000093
/hp_column Inner Error 0.000016
/hp_column Inner Error 0.000004
Inner loop converged
/hp_column Iteration 4 Outer Error 0.009108
/hp_column Inner Error 0.001293
/hp_column Inner Error 0.000337
/hp_column Inner Error 0.000121
/hp_column Inner Error 0.000015
/hp_column Inner Error 0.000001
Inner loop converged
/hp_column Iteration 5 Outer Error 0.000956
/hp_column Inner Error 0.000161
/hp_column Inner Error 0.000015
/hp_column Inner Error 0.000002
Inner loop converged
/hp_column Iteration 6 Outer Error 0.000592
/hp_column Inner Error 0.000043
/hp_column Inner Error 0.000005
Inner loop converged
/hp_column Iteration 7 Outer Error 0.000234
/hp_column Inner Error 0.000018
/hp_column Inner Error 0.000003
Inner loop converged
/hp_column Iteration 8 Outer Error 0.000088
/hp_column Inner Error 0.000002
Inner loop converged
>> 
>> cd /
/
>> hp_ovhd.Out
Port: /hp_ovhd.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.0 = 
T                  = -242.73815248407936 = F
P                  = 370.0 = psia
MoleFlow           = 75.42342076898926 = lbmole/h
MassFlow           = 2103.8373863518054 = lb/h
VolumeFlow         = 0.018264220214529153 = ft3/s
StdLiqVolumeFlow   = 0.011694800309550077 = ft3/s
H                  = -4183.655913634271 = Btu/lbmol
Energy             = -315492.57786137547 = Btu/hr
MolecularWeight    = 27.893687664152576 = 
ZFactor            = 0.1385509486654293 = 
NITROGEN           = 0.99 = 
METHANE            = 0.010000221533527085 = 
ETHANE             = 5.840636912029692e-10 = 
PROPANE            = 2.686229834903602e-09 = 
ISOBUTANE          = 5.626179771554043e-09 = 
N-BUTANE           = 2.0857309881656567e-09 = 
ISOPENTANE         = 1.1764222519314213e-10 = 
N-PENTANE          = 2.823230517212331e-11 = 

>> hp_btms.Out
Port: /hp_btms.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.0 = 
T                  = -215.48736427926158 = F
P                  = 377.0 = psia
MoleFlow           = 924.5765792310109 = lbmole/h
MassFlow           = 21101.574707748914 = lb/h
VolumeFlow         = 0.17362653735563524 = ft3/s
StdLiqVolumeFlow   = 0.14733013985779705 = ft3/s
H                  = -20767.366604210158 = Btu/lbmol
Energy             = -19197791.91201226 = Btu/hr
MolecularWeight    = 22.822960457531295 = 
ZFactor            = 0.09726038078650238 = 
NITROGEN           = 0.5091312516031407 = 
METHANE            = 0.44836280562966435 = 
ETHANE             = 0.03753069322263022 = 
PROPANE            = 0.0038936740106369017 = 
ISOBUTANE          = 0.00043263001101213666 = 
N-BUTANE           = 0.00032447268233481546 = 
ISOPENTANE         = 0.00021631522539037817 = 
N-PENTANE          = 0.000108157615190507 = 

>> 
>> # now add exchanger for overheads
>> e1 = Heater.HeatExchanger()
>> e1.DeltaPC = 0.5
>> e1.DeltaPH = 0.5
>> hp_ovhd.Out -> e1.InH
>> e1.OutH.T = -270
>> 
>> # valve
>> v1 = Valve.Valve()
>> e1.OutH -> v1.In
>> v1.Out.P = 29.3919
>> 
>> e2 = Heater.HeatExchanger()
>> e2.DeltaPH = .5
>> e2.DeltaPC = .5
>> hp_btms.Out -> e2.InH
>> e2.OutH.T = -230
>> 
>> # another valve
>> v2 = Valve.Valve()
>> e2.OutH -> /v2.In
>> v2.Out.P = 29.3919
>> 
>> lp_column = Tower.Tower()
>> lp_column.Stage_0 + 4  # six stages
>> 
>> cd lp_column.Stage_0
/lp_column.Stage_0
>> f = Tower.Feed()
>> f.Port -> /v1.Out
>> 
>> v = Tower.VapourDraw()
>> v.Port -> /e1.InC
>> v.Port.P = 29.392
>> 
>> cd ../Stage_3
/lp_column.Stage_3
>> f = Tower.Feed()
>> f.Port -> /v2.Out
>> 
>> cd ../Stage_5
/lp_column.Stage_5
>> reb = Tower.EnergyFeed(1)
>> reb.Port -> /hp_column.Stage_0.cond.Port
>> 
>> l = Tower.LiquidDraw()
>> l.Port -> /e2.InC
>> l.Port.P = 36.74
>> 
>> cd ..
/lp_column
>> TryToSolve = 1
Calculating Jacobian for /lp_column
/lp_column Inner Error 0.002929
/lp_column Inner Error 0.000970
/lp_column Inner Error 0.000076
/lp_column Inner Error 0.000017
/lp_column Inner Error 0.000001
Inner loop converged
/lp_column Iteration 1 Outer Error 0.033530
/lp_column Inner Error 0.007951
/lp_column Inner Error 0.003227
/lp_column Inner Error 0.000828
/lp_column Inner Error 0.000353
/lp_column Inner Error 0.000025
/lp_column Inner Error 0.000008
Inner loop converged
/lp_column Iteration 2 Outer Error 0.112317
/lp_column Inner Error 0.002817
/lp_column Inner Error 0.001387
/lp_column Inner Error 0.000641
/lp_column Inner Error 0.000196
/lp_column Inner Error 0.000008
Inner loop converged
/lp_column Iteration 3 Outer Error 0.074753
/lp_column Inner Error 0.004464
/lp_column Inner Error 0.001356
/lp_column Inner Error 0.000021
/lp_column Inner Error 0.000010
Inner loop converged
/lp_column Iteration 4 Outer Error 0.019535
/lp_column Inner Error 0.002490
/lp_column Inner Error 0.000743
/lp_column Inner Error 0.000002
Inner loop converged
/lp_column Iteration 5 Outer Error 0.005911
/lp_column Inner Error 0.000497
/lp_column Inner Error 0.000104
/lp_column Inner Error 0.000001
Inner loop converged
/lp_column Iteration 6 Outer Error 0.002625
/lp_column Inner Error 0.000088
/lp_column Inner Error 0.000009
Inner loop converged
/lp_column Iteration 7 Outer Error 0.001015
/lp_column Inner Error 0.000011
/lp_column Inner Error 0.000001
Inner loop converged
/lp_column Iteration 8 Outer Error 0.000394
/lp_column Inner Error 0.000002
Inner loop converged
/lp_column Iteration 9 Outer Error 0.000167
/lp_column Inner Error 0.000001
Inner loop converged
/lp_column Iteration 10 Outer Error 0.000070
/lp_column Inner Error 0.000001
Inner loop converged
>> 
>> copy /
Copied / to the clipboard
>> paste /
Pasting /
Pasted / as /RootClone
/RootClone.hp_column Inner Error 0.000000
Inner loop converged
/RootClone.hp_column Iteration 1 Outer Error 0.000031
/RootClone.hp_column Inner Error 0.000001
Inner loop converged
/RootClone.lp_column Inner Error 0.000003
Inner loop converged
/RootClone.lp_column Iteration 1 Outer Error 0.000089
/RootClone.lp_column Inner Error 0.000001
Inner loop converged
>> 
>> /e1.OutC
Port: /e1.ColdSide.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 1.0 = 
T                  = -286.4735980346435 = F
P                  = 28.892 = psia
MoleFlow           = 429.99334365811785 = lbmole/h
MassFlow           = 11929.328691680832 = lb/h
VolumeFlow         = 7.317060594442139 = ft3/s
StdLiqVolumeFlow   = 0.06668959420751877 = ft3/s
H                  = -3303.230604931416 = Btu/lbmol
Energy             = -1420128.3223470747 = Btu/hr
MolecularWeight    = 27.743054095944323 = 
ZFactor            = 0.9522475527814988 = 
NITROGEN           = 0.9774164923926507 = 
METHANE            = 0.02258350202849455 = 
ETHANE             = 2.748379722014461e-09 = 
PROPANE            = 1.4509879605061427e-09 = 
ISOBUTANE          = 9.879615342583299e-10 = 
N-BUTANE           = 3.659487644154348e-10 = 
ISOPENTANE         = 2.0627021775243974e-11 = 
N-PENTANE          = 4.949825078065127e-12 = 

>> /RootClone.e1.OutC
Port: /RootClone.e1.ColdSide.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 1.0 = 
T                  = -286.4743850303859 = F
P                  = 28.892 = psia
MoleFlow           = 429.9769798680632 = lbmole/h
MassFlow           = 11928.773453128779 = lb/h
VolumeFlow         = 7.316738288345314 = ft3/s
StdLiqVolumeFlow   = 0.06668708262003978 = ft3/s
H                  = -3303.8748330584845 = Btu/lbmol
Energy             = -1420351.2347479032 = Btu/hr
MolecularWeight    = 27.742818601859497 = 
ZFactor            = 0.9522461730274845 = 
NITROGEN           = 0.9773968202468938 = 
METHANE            = 0.02260317417373455 = 
ETHANE             = 2.7496148651461633e-09 = 
PROPANE            = 1.4506970288251932e-09 = 
ISOBUTANE          = 9.87648997760491e-10 = 
N-BUTANE           = 3.6584071216161134e-10 = 
ISOPENTANE         = 2.062162019364599e-11 = 
N-PENTANE          = 4.948610414122995e-12 = 

>> /e2.OutC
Port: /e2.ColdSide.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.11686626128057742 = 
T                  = -269.49091438141505 = F
P                  = 36.24 = psia
MoleFlow           = 570.0066563418821 = lbmole/h
MassFlow           = 11276.083402419885 = lb/h
VolumeFlow         = 1.0609168078262434 = ft3/s
StdLiqVolumeFlow   = 0.09233534595982831 = ft3/s
H                  = -31420.992834451605 = Btu/lbmol
Energy             = -17907163.271847915 = Btu/hr
MolecularWeight    = 19.782371445951405 = 
ZFactor            = 0.11897700531824705 = 
NITROGEN           = 0.21950167260842737 = 
METHANE            = 0.7115517683226944 = 
ETHANE             = 0.060876480006230714 = 
PROPANE            = 0.006315714625489494 = 
ISOBUTANE          = 0.0007017454458340634 = 
N-BUTANE           = 0.0005263093672795548 = 
ISOPENTANE         = 0.0003508730799988389 = 
N-PENTANE          = 0.0001754365440455998 = 

>> /RootClone.e2.OutC
Port: /RootClone.e2.ColdSide.Out + sim21.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.11687358856538999 = 
T                  = -269.4952167787864 = F
P                  = 36.24 = psia
MoleFlow           = 570.0230201319367 = lbmole/h
MassFlow           = 11276.638638715494 = lb/h
VolumeFlow         = 1.0609844257990435 = ft3/s
StdLiqVolumeFlow   = 0.09233785754789446 = ft3/s
H                  = -31419.775499174815 = Btu/lbmol
Energy             = -17906983.559472673 = Btu/hr
MolecularWeight    = 19.78277760800857 = 
ZFactor            = 0.11898386440486206 = 
NITROGEN           = 0.2195382689204706 = 
METHANE            = 0.7115171512765904 = 
ETHANE             = 0.06087473240939864 = 
PROPANE            = 0.006315533318988458 = 
ISOBUTANE          = 0.0007017253009204623 = 
N-BUTANE           = 0.0005262942584800883 = 
ISOPENTANE         = 0.0003508630074043087 = 
N-PENTANE          = 0.00017543150774694256 = 

