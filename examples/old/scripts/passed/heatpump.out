>> # Depeopanizer test (from old Hysim manual)
>> units Field
>> $thermo = Sim21Thermo.Peng-Robinson
pkgName: Peng-Robinson
>> / -> $thermo
Thermo case attached to a unit operation. / to /thermo
>> thermo + Propane ISOBUTANE n-BUTANE ISOPENTANE
Propane ISOBUTANE n-BUTANE ISOPENTANE 
>> 
>> Feed = Stream.Stream_Material()
>> Feed.In.T = 90
>> Feed.In.P = 55
>> Feed.In.MoleFlow = 3000
>> Feed.In.Fraction = 2.5 39 58 .5
>> 
>> c4split = Tower.Tower()
>> c4split.Stage_0 + 38  # forty stages`
>> 
>> cd c4split.Stage_0
/c4split.Stage_0
>> 
>> l = Tower.LiquidDraw()
>> l.Port.P = 60
>> l.nC4spec = Tower.VolFractionSpec()
>> l.nC4spec + n-BUTANE
>> l.nC4spec.Port = .05
>> 
>> reflux = Tower.RefluxRatioSpec()
>> reflux.Port = 7
>> 
>> cond = Tower.EnergyFeed(0)
>> estT = Tower.Estimate('T')
>> estT.Port = 100
>> 
>> cd ../Stage_1
/c4split.Stage_1
>> vap = Tower.InternalVapourClone()
>> /to_comp = Stream.Stream_Material()
>> vap.Port -> /to_comp.In
>> 
>> cd ../Stage_29
/c4split.Stage_29
>> f = Tower.Feed()
>> f.Port -> /Feed.Out
>> 
>> cd ../Stage_39
/c4split.Stage_39
>> l = Tower.LiquidDraw()
>> l.Port.P = 68
>> 
>> reb = Tower.EnergyFeed(1)
>> 
>> estT = Tower.Estimate('T')
>> estT.Port = 120
>> 
>> cd ..
/c4split
>> 
>> /liq_prod = Stream.Stream_Material()
>> /liq_prod.clone = Stream.ClonePort(1)
>> /liq_prod.In -> Stage_0.l.Port
>> 
>> /btm_prod = Stream.Stream_Material()
>> /btm_prod.In -> Stage_39.l.Port
>> 
>> TryToSolve = 1  # start calculation
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.045623
/c4split Inner Error 0.018955
/c4split Inner Error 0.003893
/c4split Inner Error 0.000759
/c4split Inner Error 0.000054
/c4split Inner Error 0.000021
/c4split Inner Error 0.000013
Inner loop is not changing significantly - exiting
/c4split Iteration 1 Outer Error 0.004348
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.038290
/c4split Inner Error 0.022148
Step size too small - Exiting inner loop
/c4split Iteration 2 Outer Error 0.001315
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.083569
/c4split Inner Error 0.051719
/c4split Inner Error 0.024147
/c4split Inner Error 0.010428
/c4split Inner Error 0.004245
/c4split Inner Error 0.002173
/c4split Inner Error 0.000627
/c4split Inner Error 0.000312
Step size too small - Exiting inner loop
/c4split Iteration 3 Outer Error 0.000869
Calculating Jacobian for /c4split
Calculating disturbance 10 of 40 in jacobian of /c4split
Calculating disturbance 20 of 40 in jacobian of /c4split
Calculating disturbance 30 of 40 in jacobian of /c4split
Calculating disturbance 40 of 40 in jacobian of /c4split
/c4split Inner Error 0.011214
/c4split Inner Error 0.010065
/c4split Inner Error 0.007992
/c4split Inner Error 0.007948
/c4split Inner Error 0.006434
/c4split Inner Error 0.001667
/c4split Inner Error 0.000207
/c4split Inner Error 0.000052
/c4split Inner Error 0.000005
Inner loop converged
/c4split Iteration 4 Outer Error 0.000035
/c4split Inner Error 0.000443
/c4split Inner Error 0.000008
Inner loop converged
>> 
>> /liq_prod.Out
Port: /liq_prod.Out + sim21.old.solver.Ports.Port_Material
Connected to: None
VapFrac            = 7.14796327596122e-06 = 
T                  = 81.6245574777519 = F
P                  = 60.0 = psia
MoleFlow           = 991.2411002069988 = lbmole/h
MassFlow           = 56561.18456726719 = lb/h
VolumeFlow         = 0.4380585820966873 = ft3/s
StdLiqVolumeFlow   = 0.4495842995319403 = ft3/s
H                  = -65177.02419753528 = Btu/lbmol
Energy             = -64595280.94084676 = Btu/hr
MolecularWeight    = 57.06097584830335 = 
ZFactor            = 0.016432612679950644 = 
PROPANE            = 0.0756580823989991 = 
ISOBUTANE          = 0.8736157858524611 = 
N-BUTANE           = 0.050726125830375814 = 
ISOPENTANE         = 5.9181639721553865e-09 = 

>> /btm_prod.Out
Port: /btm_prod.Out + sim21.old.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.0 = 
T                  = 114.64077174907466 = F
P                  = 68.0 = psia
MoleFlow           = 2008.7588997930068 = lbmole/h
MassFlow           = 116963.8206327331 = lb/h
VolumeFlow         = 0.9160197788523177 = ft3/s
StdLiqVolumeFlow   = 0.9044231771154927 = ft3/s
H                  = -62646.24531760905 = Btu/lbmol
Energy             = -125820041.23988582 = Btu/hr
MolecularWeight    = 58.22690848801501 = 
ZFactor            = 0.018112363397175923 = 
PROPANE            = 2.2895546422934013e-06 = 
ISOBUTANE          = 0.15135521107323407 = 
N-BUTANE           = 0.8411752049470842 = 
ISOPENTANE         = 0.007467294425039419 = 

>> 
>> cd /
/
>> K-100 = Compressor.Compressor()
>> K-100.Efficiency = .75
>> K-100.Out.P = 235.1787
>> 
>> c4split.Stage_1.vap.Port -> K-100.In
>> 
>> E-100 = Heater.Cooler()
>> E-100.DeltaP = 5
>> 
>> K-100.Out -> E-100.In
>> E-100.OutQ -> c4split.Stage_39.reb.Port
>> 
>> E-101 = Heater.Cooler()
>> E-101.DeltaP = 5
>> E-100.Out -> E-101.In
>> 
>> CV-100 = Valve.Valve()
>> E-101.Out -> CV-100.In
>> 
>> V-100 = Flash.SimpleFlash()
>> CV-100.Out -> V-100.In
>> 
>> split = Split.Splitter()
>> V-100.Liq0 -> split.In
>> split.Out0 -> liq_prod.clone
>> 
>> copy /
Copied / to the clipboard
>> paste /
Pasting /
Pasted / as /RootClone
/RootClone.c4split Inner Error 0.000002
Inner loop converged
/RootClone.c4split Iteration 1 Outer Error 0.000001
/RootClone.c4split Inner Error 0.000002
Inner loop converged
>> 
>> /btm_prod.In
Port: /btm_prod.In + sim21.old.solver.Ports.Port_Material
Connected to: /c4split.LiquidDraw_39_l
VapFrac            = 0.0 | 
T                  = 114.64077174907466 | F
P                  = 68.0 | psia
MoleFlow           = 2008.7588997930068 | lbmole/h
MassFlow           = 116963.8206327331 | lb/h
VolumeFlow         = 0.9160197788523177 | ft3/s
StdLiqVolumeFlow   = 0.9044231771154927 | ft3/s
H                  = -62646.24531760905 | Btu/lbmol
Energy             = -125820041.23988582 | Btu/hr
MolecularWeight    = 58.22690848801501 | 
ZFactor            = 0.018112363397175923 | 
PROPANE            = 2.2895546422934013e-06 | 
ISOBUTANE          = 0.15135521107323407 | 
N-BUTANE           = 0.8411752049470842 | 
ISOPENTANE         = 0.007467294425039419 | 

>> /RootClone.btm_prod.In
Port: /RootClone.btm_prod.In + sim21.old.solver.Ports.Port_Material
Connected to: /RootClone.c4split.LiquidDraw_39_l
VapFrac            = 2.2186106194462795e-06 | 
T                  = 114.64381354670338 | F
P                  = 68.0 | psia
MoleFlow           = 2008.4607949492581 | lbmole/h
MassFlow           = 116946.49429848103 | lb/h
VolumeFlow         = 0.915981305381559 | ft3/s
StdLiqVolumeFlow   = 0.9042849782148356 | ft3/s
H                  = -62645.74630784289 | Btu/lbmol
Energy             = -125800367.15813176 | Btu/hr
MolecularWeight    = 58.22692411650265 | 
ZFactor            = 0.018114194930720494 | 
PROPANE            = 2.283679567160319e-06 | 
ISOBUTANE          = 0.15123582050894674 | 
N-BUTANE           = 0.8412934930563746 | 
ISOPENTANE         = 0.007468402755111483 | 

