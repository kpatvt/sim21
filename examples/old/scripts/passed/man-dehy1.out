>> #dehydration plant
>> $thermo = Sim21Thermo.Peng-Robinson
pkgName: Peng-Robinson
>> / -> $thermo
Thermo case attached to a unit operation. / to /thermo
>> thermo + WATER NITROGEN CARBON_DIOXIDE METHANE ETHANE PROPANE ISOBUTANE N-BUTANE ISOPENTANE
WATER NITROGEN CARBON DIOXIDE METHANE ETHANE PROPANE ISOBUTANE N-BUTANE ISOPENTANE 
>> thermo + N-PENTANE N-HEXANE N-OCTANE BENZENE TOLUENE ETHYLBENZENE O-XYLENE TRIETHYLENE_GLYCOL
N-PENTANE N-HEXANE N-OCTANE BENZENE TOLUENE ETHYLBENZENE O-XYLENE TRIETHYLENE GLYCOL 
>> 
>> units Field
>> 
>> #define feed to dehydration plant
>> Feed = Stream.Stream_Material()
>> Feed.In.MoleFlow = 100
>> Feed.In.Fraction = 0.0022 0.0041 0.0186 0.8954 0.0469 0.0161 0.0043 0.0053 0.0021 0.0016 0.0022 .0016 0.000256 0.00018 0.000100 0.000095 0.0
>> 
>> Feed.In.T = 120
>> Feed.In.P = 1000
>> Feed.In
Port: /Feed.In + sim21.old.solver.Ports.Port_Material
Connected to: None
VapFrac            = 1.0 = 
T                  = 120.0 * F
P                  = 1000.0000000000001 * psia
MoleFlow           = 100.0 * lbmole/h
MassFlow           = 1869.294769037123 = lb/h
VolumeFlow         = 0.14955095083301054 = ft3/s
StdLiqVolumeFlow   = 0.017135317803793328 = ft3/s
H                  = -35707.89719799 = Btu/lbmol
Energy             = -3570189.2522865357 = Btu/hr
MolecularWeight    = 18.692947690371227 = 
ZFactor            = 0.8654549948775475 = 
WATER              = 0.002197734136105675 * 
NITROGEN           = 0.004095777253651485 * 
CARBON DIOXIDE     = 0.018580843150711613 * 
METHANE            = 0.8944777933950098 * 
ETHANE             = 0.04685169590152553 * 
PROPANE            = 0.016083417996046075 * 
ISOBUTANE          = 0.004295571266024729 * 
N-BUTANE           = 0.005294541327890944 * 
ISOPENTANE         = 0.0020978371299190533 * 
N-PENTANE          = 0.0015983520989859455 * 
N-HEXANE           = 0.002197734136105675 * 
N-OCTANE           = 0.0015983520989859455 * 
BENZENE            = 0.0002557363358377513 * 
TOLUENE            = 0.00017981461113591887 * 
ETHYLBENZENE       = 9.989700618662159e-05 * 
O-XYLENE           = 9.490215587729052e-05 * 
TRIETHYLENE GLYCOL = 0.0 * 

>> 
>> Lean = Stream.Stream_Material()
>> Lean.In.T = 130.0022
>> Lean.In.P = 1000
>> Lean.In.MoleFlow = 5
>> Lean.In.Fraction = 0.14 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.86
>> Lean.In
Port: /Lean.In + sim21.old.solver.Ports.Port_Material
Connected to: None
VapFrac            = 0.0 = 
T                  = 130.00220000000002 * F
P                  = 1000.0000000000001 * psia
MoleFlow           = 5.0 * lbmole/h
MassFlow           = 658.3545959999999 = lb/h
VolumeFlow         = 0.00316594395022758 = ft3/s
StdLiqVolumeFlow   = 0.0026225736931686327 = ft3/s
H                  = -311915.4218923394 = Btu/lbmol
Energy             = -1559314.849440553 = Btu/hr
MolecularWeight    = 131.6709192 = 
ZFactor            = 0.36021243264730557 = 
WATER              = 0.14 * 
NITROGEN           = 0.0 * 
CARBON DIOXIDE     = 0.0 * 
METHANE            = 0.0 * 
ETHANE             = 0.0 * 
PROPANE            = 0.0 * 
ISOBUTANE          = 0.0 * 
N-BUTANE           = 0.0 * 
ISOPENTANE         = 0.0 * 
N-PENTANE          = 0.0 * 
N-HEXANE           = 0.0 * 
N-OCTANE           = 0.0 * 
BENZENE            = 0.0 * 
TOLUENE            = 0.0 * 
ETHYLBENZENE       = 0.0 * 
O-XYLENE           = 0.0 * 
TRIETHYLENE GLYCOL = 0.86 * 

>> 
>> dehy = Tower.Tower()
>> dehy.Stage_0 + 10
>> 
>> cd dehy.Stage_0
/dehy.Stage_0
>> v = Tower.VapourDraw()
>> v.Port.P = 995
>> estT = Tower.Estimate('T')
>> estT.Value = 130
>> lFeed = Tower.Feed()
>> /Lean.Out -> lFeed.Port
>> 
>> cd ../Stage_11
/dehy.Stage_11
>> l = Tower.LiquidDraw()
>> l.Port.P = 1000
>> estT = Tower.Estimate('T')
>> estT.Value = 120
>> vFeed = Tower.Feed()
>> /Feed.Out -> vFeed.Port
>> 
>> cd ..
/dehy
>> /dryGas = Stream.Stream_Material()
>> /Rich = Stream.Stream_Material()
>> 
>> /dryGas.In -> Stage_0.v.Port
>> /Rich.In -> Stage_11.l.Port
>> 
>> InitKPower = 0  # says to use combined feed composition and est T and P on each stage to get initial Ks
>> TryToSolve = 1
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.039810
/dehy Inner Error 0.028940
/dehy Inner Error 0.014424
/dehy Inner Error 0.013670
Step size too small - Exiting inner loop
/dehy Iteration 1 Outer Error 0.551936
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.101410
/dehy Inner Error 0.101108
/dehy Inner Error 0.099873
/dehy Inner Error 0.099280
/dehy Inner Error 0.097919
/dehy Inner Error 0.097195
Step size too small - Exiting inner loop
/dehy Iteration 2 Outer Error 0.889049
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.518471
/dehy Inner Error 0.417792
/dehy Inner Error 0.332331
/dehy Inner Error 0.332038
/dehy Inner Error 0.186352
Step size too small - Exiting inner loop
/dehy Iteration 3 Outer Error 0.473026
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.169580
/dehy Inner Error 0.167664
/dehy Inner Error 0.166667
/dehy Inner Error 0.166407
/dehy Inner Error 0.166319
/dehy Inner Error 0.166275
Step size too small - Exiting inner loop
/dehy Iteration 4 Outer Error 5.934970
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 2.793511
/dehy Inner Error 2.767416
/dehy Inner Error 2.663887
/dehy Inner Error 2.376335
/dehy Inner Error 1.665019
Step size too small - Exiting inner loop
/dehy Iteration 5 Outer Error 11.276765
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Step size too small - Exiting inner loop
/dehy Iteration 6 Outer Error 6.758775
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.424811
/dehy Inner Error 0.424684
/dehy Inner Error 0.424099
/dehy Inner Error 0.420155
/dehy Inner Error 0.411931
/dehy Inner Error 0.404852
/dehy Inner Error 0.368398
Step size too small - Exiting inner loop
/dehy Iteration 7 Outer Error 1.360468
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.216988
/dehy Inner Error 0.215032
/dehy Inner Error 0.215023
Inner loop is not changing significantly - exiting
/dehy Iteration 8 Outer Error 2.244489
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.264494
/dehy Inner Error 0.262199
/dehy Inner Error 0.259917
/dehy Inner Error 0.258731
/dehy Inner Error 0.257099
Step size too small - Exiting inner loop
/dehy Iteration 9 Outer Error 14074461.066920
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 14.231096
/dehy Inner Error 13.398677
/dehy Inner Error 12.794497
/dehy Inner Error 12.334775
/dehy Inner Error 11.991032
/dehy Inner Error 11.746421
/dehy Inner Error 11.587649
/dehy Inner Error 11.496933
/dehy Inner Error 11.448049
Step size too small - Exiting inner loop
/dehy Iteration 10 Outer Error 2241373965565.212891
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.306453
Inner loop is not changing significantly - exiting
/dehy Iteration 11 Outer Error 8.692514
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.676439
Step size too small - Exiting inner loop
/dehy Iteration 12 Outer Error 4.797074
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.177434
/dehy Inner Error 0.173719
/dehy Inner Error 0.171298
/dehy Inner Error 0.168742
/dehy Inner Error 0.166219
/dehy Inner Error 0.163311
/dehy Inner Error 0.159476
/dehy Inner Error 0.155009
/dehy Inner Error 0.145970
/dehy Inner Error 0.139060
/dehy Inner Error 0.126812
/dehy Inner Error 0.116563
Step size too small - Exiting inner loop
/dehy Iteration 13 Outer Error 0.761736
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.154927
/dehy Inner Error 0.154711
/dehy Inner Error 0.154248
/dehy Inner Error 0.153873
/dehy Inner Error 0.153855
/dehy Inner Error 0.153657
/dehy Inner Error 0.153171
Step size too small - Exiting inner loop
/dehy Iteration 14 Outer Error 0.822689
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.140999
/dehy Inner Error 0.139893
/dehy Inner Error 0.137764
/dehy Inner Error 0.134233
/dehy Inner Error 0.131404
/dehy Inner Error 0.130459
Step size too small - Exiting inner loop
/dehy Iteration 15 Outer Error 0.422906
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.139616
/dehy Inner Error 0.139271
/dehy Inner Error 0.139128
/dehy Inner Error 0.139079
/dehy Inner Error 0.139061
/dehy Inner Error 0.139054
Inner loop is not changing significantly - exiting
/dehy Iteration 16 Outer Error 1.041317
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Step size too small - Exiting inner loop
/dehy Iteration 17 Outer Error 0.699027
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.072971
Inner loop is not changing significantly - exiting
/dehy Iteration 18 Outer Error 0.257629
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.129909
Inner loop is not changing significantly - exiting
/dehy Iteration 19 Outer Error 0.229214
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Step size too small - Exiting inner loop
/dehy Iteration 20 Outer Error 0.291196
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Step size too small - Exiting inner loop
/dehy Iteration 21 Outer Error 0.090922
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.119921
Inner loop is not changing significantly - exiting
/dehy Iteration 22 Outer Error 0.083729
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.123163
Inner loop is not changing significantly - exiting
/dehy Iteration 23 Outer Error 0.047704
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.121967
/dehy Inner Error 0.121888
/dehy Inner Error 0.121673
/dehy Inner Error 0.121090
/dehy Inner Error 0.119507
/dehy Inner Error 0.115124
/dehy Inner Error 0.104295
/dehy Inner Error 0.086369
/dehy Inner Error 0.054507
/dehy Inner Error 0.052024
/dehy Inner Error 0.020750
/dehy Inner Error 0.009756
/dehy Inner Error 0.008246
/dehy Inner Error 0.007696
/dehy Inner Error 0.003899
/dehy Inner Error 0.003080
/dehy Inner Error 0.003038
/dehy Inner Error 0.002988
/dehy Inner Error 0.002172
/dehy Inner Error 0.001849
/dehy Iteration 24 Outer Error 1.118041
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.077054
/dehy Inner Error 0.069354
/dehy Inner Error 0.065192
/dehy Inner Error 0.058739
/dehy Inner Error 0.040393
/dehy Inner Error 0.034251
/dehy Inner Error 0.021893
/dehy Inner Error 0.020643
/dehy Inner Error 0.020476
/dehy Inner Error 0.019865
/dehy Inner Error 0.019454
/dehy Inner Error 0.019181
/dehy Inner Error 0.019014
/dehy Inner Error 0.018700
Step size too small - Exiting inner loop
/dehy Iteration 25 Outer Error 0.680200
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.078953
/dehy Inner Error 0.078033
/dehy Inner Error 0.076970
/dehy Inner Error 0.075956
/dehy Inner Error 0.074091
/dehy Inner Error 0.072517
/dehy Inner Error 0.072127
/dehy Inner Error 0.072011
Step size too small - Exiting inner loop
/dehy Iteration 26 Outer Error 1.545492
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.144662
Inner loop is not changing significantly - exiting
/dehy Iteration 27 Outer Error 0.969169
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.087868
/dehy Inner Error 0.077266
/dehy Inner Error 0.050960
/dehy Inner Error 0.029457
/dehy Inner Error 0.026505
/dehy Inner Error 0.025862
/dehy Inner Error 0.020405
Step size too small - Exiting inner loop
/dehy Iteration 28 Outer Error 0.380041
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.138471
/dehy Inner Error 0.138435
/dehy Inner Error 0.138384
/dehy Inner Error 0.137896
/dehy Inner Error 0.134878
/dehy Inner Error 0.128447
/dehy Inner Error 0.127341
/dehy Inner Error 0.116541
/dehy Inner Error 0.107144
/dehy Inner Error 0.103208
/dehy Inner Error 0.103064
/dehy Inner Error 0.098706
Step size too small - Exiting inner loop
/dehy Iteration 29 Outer Error 1.157118
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.132102
/dehy Inner Error 0.128568
/dehy Inner Error 0.128193
Step size too small - Exiting inner loop
/dehy Iteration 30 Outer Error 0.834102
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.234233
/dehy Inner Error 0.231050
/dehy Inner Error 0.219621
/dehy Inner Error 0.217827
Step size too small - Exiting inner loop
/dehy Iteration 31 Outer Error 0.835110
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.271698
/dehy Inner Error 0.220906
/dehy Inner Error 0.199031
/dehy Inner Error 0.186069
/dehy Inner Error 0.174819
/dehy Inner Error 0.156739
Step size too small - Exiting inner loop
/dehy Iteration 32 Outer Error 1.009234
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 0.630264
/dehy Inner Error 0.622852
/dehy Inner Error 0.583294
/dehy Inner Error 0.498683
/dehy Inner Error 0.461337
/dehy Inner Error 0.434809
/dehy Inner Error 0.402687
/dehy Inner Error 0.389271
/dehy Inner Error 0.362715
/dehy Inner Error 0.288465
/dehy Inner Error 0.260539
/dehy Inner Error 0.230990
/dehy Inner Error 0.203435
/dehy Inner Error 0.171807
/dehy Inner Error 0.143176
/dehy Inner Error 0.131692
/dehy Inner Error 0.121447
/dehy Inner Error 0.119339
Step size too small - Exiting inner loop
/dehy Iteration 33 Outer Error 11.613958
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
/dehy Inner Error 50.381628
/dehy Inner Error 50.334098
/dehy Inner Error 50.301794
/dehy Inner Error 50.277079
/dehy Inner Error 50.246724
/dehy Inner Error 50.235300
/dehy Inner Error 50.214569
/dehy Inner Error 50.111657
/dehy Inner Error 49.714176
/dehy Inner Error 49.585174
Step size too small - Exiting inner loop
/dehy Iteration 34 Outer Error 1.000000
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Step size too small - Exiting inner loop
/dehy Iteration 35 Outer Error 29.737526
Calculating Jacobian for /dehy
Calculating disturbance 10 of 12 in jacobian of /dehy
Could not invert Jacobian in /dehy
/dehy failed to converge in 35 iterations - error = 29.737526
>> 
>> Stage_0.v.Port
Port: /dehy.VapourDraw_0_v + sim21.old.solver.Ports.Port_Material
Connected to: /dryGas.In
VapFrac            = None
T                  = None
P                  = 995.0 * psia
MoleFlow           = None
MassFlow           = None
VolumeFlow         = None
StdLiqVolumeFlow is invalid
H                  = None
Energy             = None
MolecularWeight    = None
ZFactor            = None
WATER              = None
NITROGEN           = None
CARBON DIOXIDE     = None
METHANE            = None
ETHANE             = None
PROPANE            = None
ISOBUTANE          = None
N-BUTANE           = None
ISOPENTANE         = None
N-PENTANE          = None
N-HEXANE           = None
N-OCTANE           = None
BENZENE            = None
TOLUENE            = None
ETHYLBENZENE       = None
O-XYLENE           = None
TRIETHYLENE GLYCOL = None

>> Stage_11.l.Port
Port: /dehy.LiquidDraw_11_l + sim21.old.solver.Ports.Port_Material
Connected to: /Rich.In
VapFrac            = None
T                  = None
P                  = 1000.0000000000001 * psia
MoleFlow           = None
MassFlow           = None
VolumeFlow         = None
StdLiqVolumeFlow is invalid
H                  = None
Energy             = None
MolecularWeight    = None
ZFactor            = None
WATER              = None
NITROGEN           = None
CARBON DIOXIDE     = None
METHANE            = None
ETHANE             = None
PROPANE            = None
ISOBUTANE          = None
N-BUTANE           = None
ISOPENTANE         = None
N-PENTANE          = None
N-HEXANE           = None
N-OCTANE           = None
BENZENE            = None
TOLUENE            = None
ETHYLBENZENE       = None
O-XYLENE           = None
TRIETHYLENE GLYCOL = None

>> 
>> copy /
Copied / to the clipboard
>> paste /
Pasting /
Pasted / as /RootClone
Step size too small - Exiting inner loop
/RootClone.dehy Iteration 1 Outer Error 4.783268
Calculating Jacobian for /RootClone.dehy
Calculating disturbance 10 of 12 in jacobian of /RootClone.dehy
Step size too small - Exiting inner loop
/RootClone.dehy Iteration 2 Outer Error 32073375156255498245599395840.000000
Calculating Jacobian for /RootClone.dehy
Calculating disturbance 10 of 12 in jacobian of /RootClone.dehy
Could not invert Jacobian in /RootClone.dehy
/RootClone.dehy failed to converge in 2 iterations - error = 32073375156255498245599395840.000000
>> cd /RootClone.dehy
/RootClone.dehy
>> Stage_0.v.Port
Port: /RootClone.dehy.VapourDraw_0_v + sim21.old.solver.Ports.Port_Material
Connected to: /RootClone.dryGas.In
VapFrac            = None
T                  = None
P                  = 995.0 * psia
MoleFlow           = None
MassFlow           = None
VolumeFlow         = None
StdLiqVolumeFlow is invalid
H                  = None
Energy             = None
MolecularWeight    = None
ZFactor            = None
WATER              = None
NITROGEN           = None
CARBON DIOXIDE     = None
METHANE            = None
ETHANE             = None
PROPANE            = None
ISOBUTANE          = None
N-BUTANE           = None
ISOPENTANE         = None
N-PENTANE          = None
N-HEXANE           = None
N-OCTANE           = None
BENZENE            = None
TOLUENE            = None
ETHYLBENZENE       = None
O-XYLENE           = None
TRIETHYLENE GLYCOL = None

>> Stage_11.l.Port
Port: /RootClone.dehy.LiquidDraw_11_l + sim21.old.solver.Ports.Port_Material
Connected to: /RootClone.Rich.In
VapFrac            = None
T                  = None
P                  = 1000.0000000000001 * psia
MoleFlow           = None
MassFlow           = None
VolumeFlow         = None
StdLiqVolumeFlow is invalid
H                  = None
Energy             = None
MolecularWeight    = None
ZFactor            = None
WATER              = None
NITROGEN           = None
CARBON DIOXIDE     = None
METHANE            = None
ETHANE             = None
PROPANE            = None
ISOBUTANE          = None
N-BUTANE           = None
ISOPENTANE         = None
N-PENTANE          = None
N-HEXANE           = None
N-OCTANE           = None
BENZENE            = None
TOLUENE            = None
ETHYLBENZENE       = None
O-XYLENE           = None
TRIETHYLENE GLYCOL = None

>> 
